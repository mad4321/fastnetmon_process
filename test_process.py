#!/usr/bin/env python

import subprocess

test_files1 = [
(False,'185.41.23.154_24_02_20_14:34:26')]


test_files = [
(False,'185.41.23.154_24_02_20_14:34:26'),
(False,'185.41.23.154_24_02_20_21:49:59'),
(True,'185.41.23.155_21_02_20_19:12:15'),
(False,'185.41.23.155_24_02_20_09:36:13'),
(False,'185.41.23.155_24_02_20_10:06:14'),
(False,'185.41.23.155_24_02_20_13:36:45'),
(True,'194.187.28.250_23_02_20_20:16:00'),
(True,'194.187.28.91_23_02_20_20:19:25'),
(True,'31.135.177.11_23_02_20_19:48:59'),
(True,'31.135.177.1_22_02_20_20:02:05'),
(True,'31.135.177.1_23_02_20_18:36:55'),
(True,'31.135.177.1_23_02_20_19:20:02'),
(True,'31.135.177.1_25_02_20_18:59:19'),
(True,'31.135.177.170_20_02_20_20:02:23'),
(True,'31.135.177.170_22_02_20_20:36:32'),
(True,'31.135.177.170_23_02_20_19:57:59'),
(True,'31.135.177.171_22_02_20_20:38:57'),
(True,'31.135.177.172_22_02_20_20:41:52'),
(True,'31.135.177.173_22_02_20_20:49:53'),
(True,'31.135.177.174_22_02_20_20:52:23'),
(True,'31.135.177.175_22_02_20_20:54:58'),
(True,'31.135.177.175_23_02_20_18:44:20'),
(True,'31.135.177.176_22_02_20_20:57:58'),
(True,'31.135.177.176_23_02_20_18:47:05'),
(True,'31.135.177.186_22_02_20_20:32:52'),
(True,'31.135.177.201_20_02_20_19:54:37'),
(True,'31.135.177.209_20_02_20_19:58:22'),
(False,'31.135.177.2_22_02_20_21:06:29'),
(False,'31.135.177.2_22_02_20_21:40:26'),
(False,'31.135.177.2_22_02_20_22:11:27'),
(False,'31.135.177.2_22_02_20_22:42:34'),
(False,'31.135.177.2_22_02_20_23:13:30'),
(False,'31.135.177.2_22_02_20_23:44:36'),
(False,'31.135.177.2_23_02_20_00:15:33'),
(False,'31.135.177.2_23_02_20_00:46:39'),
(False,'31.135.177.2_23_02_20_01:17:41'),
(False,'31.135.177.2_23_02_20_01:48:42'),
(False,'31.135.177.2_23_02_20_02:19:44'),
(False,'31.135.177.2_23_02_20_02:50:46'),
(False,'31.135.177.2_23_02_20_03:21:47'),
(False,'31.135.177.2_23_02_20_03:52:48'),
(False,'31.135.177.2_23_02_20_04:23:49'),
(False,'31.135.177.2_23_02_20_04:54:51'),
(False,'31.135.177.2_23_02_20_06:25:55'),
(False,'31.135.177.2_23_02_20_06:56:56'),
(False,'31.135.177.2_23_02_20_07:27:58'),
(False,'31.135.177.2_23_02_20_07:58:59'),
(True,'31.135.177.28_22_02_20_20:14:51'),
(True,'31.135.177.30_22_02_20_20:05:56'),
(True,'31.135.177.31_22_02_20_20:10:51'),
(False,'31.135.177.32_23_02_20_08:25:31'),
(False,'31.135.177.32_23_02_20_08:57:32'),
(False,'31.135.177.32_23_02_20_09:33:58'),
(True,'31.135.177.35_21_02_20_19:52:05'),
(True,'31.135.177.38_22_02_20_20:28:17'),
(True,'31.135.177.40_22_02_20_20:17:57'),
(True,'31.135.177.42_20_02_20_19:47:16'),
(False,'31.135.177.4_23_02_20_19:52:34'),
(False,'31.135.177.4_23_02_20_20:23:35'),
(False,'31.135.177.4_23_02_20_20:54:37'),
(False,'31.135.177.4_23_02_20_21:25:38'),
(False,'31.135.177.4_23_02_20_21:56:40'),
(False,'31.135.177.4_23_02_20_22:27:42'),
(False,'31.135.177.4_23_02_20_22:58:42'),
(False,'31.135.177.4_23_02_20_23:30:44'),
(False,'31.135.177.4_24_02_20_00:01:46'),
(False,'31.135.177.4_24_02_20_00:32:47'),
(False,'31.135.177.4_24_02_20_01:03:49'),
(False,'31.135.177.4_24_02_20_01:34:50'),
(False,'31.135.177.4_24_02_20_02:05:52'),
(False,'31.135.177.4_24_02_20_02:36:53'),
(False,'31.135.177.4_24_02_20_03:07:55'),
(False,'31.135.177.4_24_02_20_03:38:56'),
(False,'31.135.177.4_24_02_20_04:09:57'),
(False,'31.135.177.4_24_02_20_04:40:59'),
(False,'31.135.177.4_24_02_20_05:12:00'),
(False,'31.135.177.4_24_02_20_05:43:02'),
(False,'31.135.177.4_24_02_20_06:14:03'),
(False,'31.135.177.4_24_02_20_06:45:05'),
(False,'31.135.177.4_24_02_20_07:16:07'),
(False,'31.135.177.4_24_02_20_07:49:08'),
(False,'31.135.177.4_24_02_20_08:20:15'),
(False,'31.135.177.4_24_02_20_08:52:06'),
(True,'31.135.177.48_20_02_20_19:51:36'),
(True,'31.135.177.99_20_02_20_20:12:48'),
(True,'91.241.166.10_21_02_20_11:32:42'),
(True,'91.241.166.10_21_02_20_11:49:42'),
(True,'91.241.166.10_21_02_20_12:06:42'),
(True,'91.241.166.10_21_02_20_12:23:43'),
(True,'91.241.166.10_21_02_20_12:46:43'),
(True,'91.241.166.10_21_02_20_19:51:55'),
(True,'91.241.166.10_21_02_20_20:08:46'),
(True,'91.241.166.10_21_02_20_20:25:40'),
(True,'91.241.166.109_21_02_20_13:37:43'),
(True,'91.241.166.109_21_02_20_13:54:43'),
(True,'91.241.166.211_20_02_20_20:30:24'),
(True,'91.241.166.211_20_02_20_20:48:25'),
(True,'91.241.166.211_20_02_20_21:05:26'),
(True,'91.241.166.211_20_02_20_21:22:27'),
(True,'91.241.166.211_23_02_20_10:19:31'),
(True,'91.241.166.211_24_02_20_08:45:35'),
(True,'91.241.166.211_27_02_20_22:30:31'),
(True,'91.241.166.211_27_02_20_22:47:01'),
(True,'91.241.166.23_20_02_20_20:07:38'),
(True,'91.241.166.23_20_02_20_20:34:29'),
(True,'91.241.166.23_20_02_20_20:51:40'),
(True,'91.241.166.23_20_02_20_21:08:31'),
(True,'91.241.166.23_20_02_20_21:25:27'),
(True,'91.241.166.23_21_02_20_09:50:05'),
(True,'91.241.166.23_21_02_20_10:07:00'),
(True,'91.241.166.23_21_02_20_10:24:06'),
(True,'91.241.166.23_21_02_20_10:41:06'),
(True,'91.241.166.24_20_02_20_19:56:57'),
(True,'91.241.166.24_20_02_20_20:28:24'),
(True,'91.241.166.24_21_02_20_09:50:05'),
(True,'91.241.166.24_21_02_20_10:07:00'),
(True,'91.241.166.24_21_02_20_10:24:11'),
(True,'91.241.166.24_21_02_20_10:41:06'),
(True,'91.241.166.24_21_02_20_10:58:07'),
(True,'91.241.166.25_20_02_20_20:09:58'),
(True,'91.241.166.25_23_02_20_11:32:35'),
(True,'91.241.166.25_23_02_20_17:13:51'),
(True,'91.241.166.25_23_02_20_17:45:43'),
(True,'91.241.166.25_23_02_20_20:52:26'),
(True,'91.241.166.26_20_02_20_20:12:23'),
(True,'91.241.166.26_23_02_20_11:32:35'),
(True,'91.241.166.26_23_02_20_17:13:51'),
(True,'91.241.166.26_23_02_20_17:46:42'),
(True,'91.241.166.26_23_02_20_20:54:42'),
(True,'91.241.166.27_23_02_20_11:27:49'),
(True,'91.241.166.27_23_02_20_17:13:56'),
(True,'91.241.166.27_23_02_20_17:45:43'),
(True,'91.241.166.27_23_02_20_20:38:00'),
(True,'91.241.166.27_25_02_20_20:40:59'),
(True,'91.241.166.27_27_02_20_22:30:31'),
(True,'91.241.166.27_27_02_20_22:47:01'),
(True,'91.241.166.27_27_02_20_23:32:37'),
(True,'91.241.166.36_21_02_20_10:43:33'),
(True,'91.241.166.40_20_02_20_19:59:57'),
(True,'91.241.166.40_21_02_20_10:59:42'),
(True,'91.241.166.40_22_02_20_10:02:36'),
(True,'91.241.166.40_22_02_20_10:19:47'),
(True,'91.241.166.40_22_02_20_10:36:43'),
(True,'91.241.166.40_22_02_20_10:53:44'),
(True,'91.241.166.40_22_02_20_13:53:12'),
(True,'91.241.166.40_22_02_20_14:09:04'),
(True,'91.241.166.40_22_02_20_14:25:04'),
(True,'91.241.166.40_22_02_20_16:06:14'),
(True,'91.241.166.40_22_02_20_16:21:30'),
(True,'91.241.166.40_22_02_20_16:37:31'),
(True,'91.241.166.40_22_02_20_16:53:31'),
(True,'91.241.166.40_23_02_20_10:19:51'),
(True,'91.241.166.5_21_02_20_11:12:42'),
(True,'91.241.166.5_21_02_20_11:29:42'),
(True,'91.241.166.56_21_02_20_12:49:43'),
(True,'91.241.166.56_21_02_20_13:06:43'),
(True,'91.241.166.56_21_02_20_13:23:43'),
(True,'91.241.166.60_21_02_20_12:49:43'),
(True,'91.241.166.60_21_02_20_13:06:43'),
(True,'91.241.166.60_21_02_20_13:23:43'),
(True,'91.241.166.60_21_02_20_13:40:43'),
(True,'91.241.166.60_22_02_20_14:31:14'),
(True,'91.241.166.60_22_02_20_14:36:00'),
(True,'91.241.166.60_22_02_20_14:52:00'),
(True,'91.241.166.60_22_02_20_15:08:01'),
(True,'91.241.166.60_22_02_20_15:29:02'),
(True,'91.241.166.60_22_02_20_20:12:31'),
(True,'91.241.166.60_22_02_20_20:28:32'),
(True,'91.241.166.60_22_02_20_20:44:33'),
(True,'91.241.166.60_22_02_20_21:00:33'),
(True,'91.241.166.60_23_02_20_10:20:51'),
(True,'91.241.166.60_23_02_20_10:51:18'),
(True,'91.241.166.6_21_02_20_11:12:42'),
(True,'91.241.166.6_21_02_20_11:29:42'),
(True,'91.241.166.6_24_02_20_08:43:35'),
(True,'91.241.166.6_24_02_20_11:34:44'),
(True,'91.241.166.6_24_02_20_13:46:35'),
(True,'91.241.166.7_21_02_20_11:12:42'),
(True,'91.241.166.7_21_02_20_11:29:42'),
(True,'91.241.166.7_22_02_20_14:31:59'),
(True,'91.241.166.7_22_02_20_14:36:00'),
(True,'91.241.166.7_22_02_20_14:52:00'),
(True,'91.241.166.7_22_02_20_15:08:01'),
(True,'91.241.166.72_21_02_20_10:43:22'),
(True,'91.241.166.72_21_02_20_11:00:02'),
(True,'91.241.166.80_21_02_20_12:49:43'),
(True,'91.241.166.80_21_02_20_13:06:43'),
(True,'91.241.166.80_21_02_20_13:23:43'),
(True,'91.241.166.80_21_02_20_13:41:43'),
(True,'91.241.166.80_21_02_20_19:51:45'),
(True,'91.241.166.80_21_02_20_20:08:46'),
(True,'91.241.166.80_21_02_20_20:25:40'),
(True,'91.241.166.80_22_02_20_10:02:36'),
(True,'91.241.166.80_22_02_20_10:19:37'),
(True,'91.241.166.80_22_02_20_10:36:43'),
(True,'91.241.166.80_22_02_20_10:53:39'),
(True,'91.241.166.80_22_02_20_13:53:57'),
(True,'91.241.166.80_22_02_20_14:09:04'),
(True,'91.241.166.80_22_02_20_14:25:04'),
(True,'91.241.166.80_22_02_20_16:06:04'),
(True,'91.241.166.80_22_02_20_16:21:30'),
(True,'91.241.166.80_22_02_20_16:37:31'),
(True,'91.241.166.80_22_02_20_16:53:31'),
(True,'91.241.166.8_21_02_20_11:32:42'),
(True,'91.241.166.8_21_02_20_11:49:42'),
(True,'91.241.166.8_21_02_20_12:06:52'),
(True,'91.241.166.8_21_02_20_12:24:43'),
(True,'91.241.166.8_21_02_20_12:46:43'),
(True,'91.241.166.8_22_02_20_14:31:14'),
(True,'91.241.166.8_22_02_20_14:36:00'),
(True,'91.241.166.8_22_02_20_14:52:00'),
(True,'91.241.166.8_22_02_20_15:08:01'),
(True,'91.241.166.8_22_02_20_15:29:07'),
(True,'91.241.166.8_22_02_20_20:12:31'),
(True,'91.241.166.8_22_02_20_20:28:32'),
(True,'91.241.166.8_22_02_20_20:44:33'),
(True,'91.241.166.8_22_02_20_21:00:33'),
(True,'91.241.166.90_24_02_20_08:38:50'),
(True,'91.241.166.90_27_02_20_22:40:11'),
(True,'91.241.166.90_27_02_20_22:47:01'),
(True,'91.241.166.9_21_02_20_11:32:42'),
(True,'91.241.166.9_21_02_20_11:49:42'),
(True,'91.241.166.9_21_02_20_12:06:42'),
(True,'91.241.166.9_21_02_20_12:23:43'),
(True,'91.241.166.9_21_02_20_12:46:43'),
(True,'91.241.166.9_21_02_20_19:51:45'),
(True,'91.241.166.9_21_02_20_20:08:46'),
(True,'91.241.166.9_21_02_20_20:25:45'),
(True,'91.241.166.92_20_02_20_20:19:38'),
(True,'91.241.166.92_20_02_20_20:36:39'),
(True,'91.241.166.92_20_02_20_20:53:40'),
(True,'91.241.166.92_20_02_20_21:10:31'),
(True,'91.241.166.9_22_02_20_10:02:41'),
(True,'91.241.166.9_22_02_20_10:19:42'),
(True,'91.241.166.9_22_02_20_10:36:43'),
(True,'91.241.166.9_22_02_20_10:53:44'),
(True,'91.241.166.9_22_02_20_13:53:12'),
(True,'91.241.166.9_22_02_20_14:09:04'),
(True,'91.241.166.9_22_02_20_14:25:04'),
(True,'91.241.166.9_22_02_20_16:06:04'),
(True,'91.241.166.9_22_02_20_16:21:30'),
(True,'91.241.166.9_22_02_20_16:37:31'),
(True,'91.241.166.9_22_02_20_16:53:31'),
(True,'91.241.166.9_22_02_20_20:12:31'),
(True,'91.241.166.9_22_02_20_20:28:32'),
(True,'91.241.166.9_22_02_20_20:44:33'),
(True,'91.241.166.9_22_02_20_21:00:33'),
(True,'91.241.166.92_21_02_20_09:50:05'),
(True,'91.241.166.92_21_02_20_10:07:00'),
(True,'91.241.166.92_21_02_20_10:24:06'),
(True,'91.241.166.92_21_02_20_10:41:06'),
(True,'91.241.166.92_21_02_20_10:58:12'),
(True,'91.241.166.9_24_02_20_08:42:35'),
(True,'91.241.166.9_25_02_20_17:26:41'),
(True,'91.241.166.93_24_02_20_00:08:36')]

test_path = '/var/log/fastnetmon_attacks/'

for (result,filename) in test_files:
    items = filename.split('_')
    with open(test_path+filename, 'r') as f:
#        print("cat %s | %s %s %s %s %s"%(test_path+filename,'./process_attack.py',items[0],'incoming','111111','attack_details'))
        process = subprocess.Popen(['./process_attack.py',items[0],'incoming','111111','attack_details'], stdin=f)
        rc = process.wait()
    print("testing '%s', '%s', rc=%d, expected result=%d TEST %s"%(filename,items[0],rc,not result,('OK' if rc == (not result) else 'FAIL')))

sys.exit()

